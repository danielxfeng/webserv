<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Webserv 42Project</title>
	<style>
		/* Base styles */
		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			background-color: #f9fafc;
			color: #333;
			margin: 0;
			padding: 0;
		}

		.container {
			max-width: 900px;
			margin: 40px auto;
			padding: 20px;
			background-color: #ffffff;
			border-radius: 12px;
			box-shadow: 0 10px 25px rgba(0, 0, 0, 0.07);
		}

		/* Header */
		.header {
			text-align: center;
			background-color: #2c3e50;
			color: #ecf0f1;
			padding: 30px 20px;
			border-radius: 12px 12px 0 0;
		}

		.header h3 {
			margin-bottom: 10px;
			font-size: 24px;
		}

		.header p {
			font-size: 15px;
		}

		.header a {
			color: #1abc9c;
			font-weight: bold;
			text-decoration: none;
			margin: 0 5px;
		}

		.header a:hover {
			text-decoration: underline;
			color: #16a085;
		}

		/* Main content */
		.main {
			padding: 30px 20px;
		}

		h2 {
			margin-top: 0;
			color: #2c3e50;
		}

		.upload-file-section,
		.delete-file {
			margin-bottom: 40px;
		}

		form {
			display: flex;
			flex-direction: column;
			gap: 15px;
		}

		input[type="file"] {
			padding: 8px;
			border: 1px solid #ccc;
			border-radius: 6px;
		}

		button,
		.uploadButton {
			padding: 12px 18px;
			border: none;
			background-color: #3498db;
			color: white;
			font-weight: bold;
			border-radius: 6px;
			cursor: pointer;
			transition: background-color 0.3s ease;
		}

		button:hover,
		.uploadButton:hover {
			background-color: #2980b9;
		}

		#message {
			margin-top: 12px;
			font-weight: bold;
			color: #e74c3c;
		}

		/* Footer */
		.footer {
			text-align: center;
			background-color: #ecf0f1;
			padding: 20px;
			border-radius: 0 0 12px 12px;
			color: #7f8c8d;
			font-size: 14px;
		}

		/* Responsive design */
		@media (max-width: 600px) {
			.container {
				margin: 20px;
				padding: 15px;
			}

			form {
				gap: 10px;
			}

			button,
			.uploadButton {
				width: 100%;
			}
		}
	</style>
</head>

<body>
	<div class="container">
		<div class="header">
			<h3>Welcome to our Webserver Project for 42 School</h3>
			<p>Done by:
				<a href="https://github.com/danielxfeng">Daniel Xfeng</a>,
				<a href="https://github.com/OneGameDad">Gregory Pellechi</a>, and
				<a href="https://github.com/Mohdkhlouf">Mohammad Khlouf</a>
			</p>
		</div>

		<div class="main">
			<div class="upload-file-section">
				<h2>Upload a File</h2>
				<form id="uploadForm">
					<input type="file" id="fileInput">
					<button type="submit">Upload</button>
				</form>
			</div>

			<div class="delete-file">
				<h2>Delete a File</h2>
				<input type="text" id="filenameInput" placeholder="Enter filename (e.g. test.txt)">
				<button onclick="deleteFile()">Delete File</button>
				<p id="message"></p>
			</div>
		</div>

		<div class="footer">
			<h5>Thank you so much</h5>
		</div>
	</div>

	<script>
		const form = document.getElementById('uploadForm');
		const fileInput = document.getElementById('fileInput');

		form.addEventListener('submit', async (e) => {
			e.preventDefault();

			const file = fileInput.files[0];
			if (!file) {
				alert('Please select a file!');
				return;
			}

			try {
				const response = await fetch('/uploads/', {
					method: 'POST',
					headers: {
						'Content-Type': file.type || 'application/octet-stream',
					},
					body: file,
				});

				if (response.ok) {
					alert('Upload successful!');
				} else {
					alert('Upload failed.');
				}
			} catch (err) {
				console.error('Upload error:', err);
				alert('Error uploading file.');
			}
		});

		async function deleteFile() {
			const filename = document.getElementById('filenameInput').value.trim();

			if (!filename) {
				document.getElementById('message').textContent = 'Please enter a filename.';
				return;
			}

			if (!confirm(`Are you sure you want to delete ${filename}?`)) return;

			try {
				const response = await fetch(`/uploads/${filename}`, {
					method: 'DELETE'
				});

				const text = await response.text();
				if (response.ok) {
					document.getElementById('message').textContent = `File "${filename}" deleted successfully.`;
					document.getElementById('message').style.color = '#27ae60'; // green
				} else {
					document.getElementById('message').textContent = text || `Failed to delete "${filename}".`;
					document.getElementById('message').style.color = '#e74c3c'; // red
				}
			} catch (err) {
				document.getElementById('message').textContent = 'Error deleting file.';
				document.getElementById('message').style.color = '#e74c3c';
			}
		}

	</script>
</body>

</html>